<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">

<!-- Begin Jekyll SEO tag v2.3.0 -->
<title>Custom login script</title>
<meta property="og:title" content="atutorlangs.github.io" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ATutor is an Open Source Web-based Learning Management System (LMS)." />
<meta property="og:description" content="ATutor is an Open Source Web-based Learning Management System (LMS)" />
<link rel="canonical" href="https://atutorlangs.github.io/" />
<meta property="og:url" content="https://atutorlangs.github.io/" />
<meta property="og:site_name" content="atutorlangs.github.io" />
<script type="application/ld+json">
{"name":"atutorlangs.github.io","description":"ATutor is an Open Source Web-based Learning Management System (LMS)","author":null,"@type":"WebSite","url":"https://atutorlangs.github.io/","image":null,"publisher":null,"headline":"atutorlangs.github.io","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=d21f7591e4074c34581bb4e6987280a5a8e29a48">
  </head>
  <body>
    <section class="page-header1">
     
    </section>
    <section class="main-content">
   	<a id="content" title="content area"></a>
	<div class="cd-fixed-bg cd-bg-1">
	<div class="tpbg">
		    <h1><em>AT</em>utor</h1>
	    <h2>Learning Management Tools</h2>
	    <br />
	    </div>
	</div>
	<div class="cd-scrolling-bg cd-color-2">
        <div class="clbg" style=""> 
        <div class="sidemenu1">
        <!-- Belongs at: /_includes/navigation.html -->
<nav>
<h3><a href="https://atutor.github.io/">Home</a></h3>
    
    <ul>
    <li><h3>ATutor LMS</h3>
  
        
        
          <li class=""><a href="https://atutor.github.io/atutor/index.html">ATutor Details</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/atutor/downloads.html">Downloads</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/atutor/features.html">Features</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/atutor/docs/index.html">Documentation</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/atutor/modules.html">Modules</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/atutor/themes.html">Themes</a></li>
        
        
          <li class=""><a href="https://atutorlangs.github.io/index.html">Translation</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/atutor/repositories.html">Code Repositories</a></li>
        
        
          <li class=""><a href="https://atutorlangs.github.io/atutor/archive/exported_forum1.html">Support Forum Archive</a></li>
        
      </ul>
  
    <ul>
    <li><h3>AContent LCMS</h3>
  
        
        
          <li class=""><a href="https://atutor.github.io/acontent/index.html">AContent Details</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/acontent/downloads.html">Downloads</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/acontent/docs/index.html">Documentation</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/acontent/languages.html">Translation</a></li>
        
      </ul>
  
    <ul>
    <li><h3>Developers</h3>
  
        
        
          <li class=""><a href="https://atutor.github.io/developer/guidelines.html">Developer Docs</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/developer/modules.html">Module Developer</a></li>
        
        
          <li class=""><a href="https://atutor.github.io/developer/languages.html">Translation</a></li>
        
        
          <li class=""><a href="https://github.com/atutor/ATutor/issues">Report Issues</a></li>
        
      </ul>
  
</nav>
        <hr>
        <script>
          (function() {
            var cx = '003504471195032332048:igzbiihmmcg';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
          })();
        </script>
        <div class="gsearch"><gcse:searchbox-only></gcse:searchbox-only>
                </div>
                <hr />
             <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
             <!-- githubfoot -->
             <ins class="adsbygoogle"
                  style="display:block"
                  data-ad-client="ca-pub-2250446123648311"
                  data-ad-slot="4063107943"
                  data-ad-format="auto"></ins>
             <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
             </script>
        </div>
        <div class="contentstart">
        <ol class="breadcrumbs">
            <li><a href="https://atutor.github.io/">Home</a></li>
            
        </ol>
        <div class='threadlist'>
<br /><div><a href='exported_forum1.html' class='midtext'>Back to: Thread list</a></div>
<br /><br /><div><strong>Pages:</strong><a href="exported_forum1.html?page=1">1</a> <a href="exported_forum2.html?page=2">2</a> <a href="exported_forum3.html?page=3">3</a> <a href="exported_forum4.html?page=4">4</a> <a href="exported_forum5.html?page=5">5</a> <strong><a href="exported_forum6.html">6</a></strong> <a href="exported_forum7.html?page=7">7</a> <a href="exported_forum8.html?page=8">8</a> <a href="exported_forum9.html?page=9">9</a> <a href="exported_forum10.html?page=10">10</a> <a href="exported_forum11.html?page=11">11</a> <a href="exported_forum12.html?page=12">12</a> <a href="exported_forum13.html?page=13">13</a> <a href="exported_forum14.html?page=14">14</a> <a href="exported_forum15.html?page=15">15</a> </div>
<div><p><br /><h3>Custom login script</h3></div><br />
<div><ul class='forum-thread'>

	<li class="even">
		<a name="14863"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 08:19:44</p>
            </div>
            <div class="postheader"><h3>Custom login script</h3></div>
				
			<div class="body">
				<p>Hi,<br />
I'm trying to place a login box on our website's homepage that will log a user straight into the ATutor LMS. However, it is not authenticating the user. Once on the login.php, of course, the user can re-type their username and password and gain access but it sort of defeats the object.<br />
<br />
I have copied in the javascript code but no doubt missing something simple.<br />
<br />
Any help would be appreciated - or some code for me to place on the page - even better.<br />
<br />
Cheers,<br />
Jim<br />
Version 1.6.1</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="14864"></a>
		<div class="forum-post-author">
			<label class="title">greg</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 09:53:00</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Maybe take a look at the HTML source code for the login form we use on our demo site. Make sure the encryption script is properly called.<br />
<br />
<br />
http://www.atutor.ca/atutor/demo.php</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="14867"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 11:29:00</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Thanks Greg, I had a look at the page - doesn't look too dissimilar to my code.<br />
I have the following code to produce my login box - starting at :<br />
<br />
&lt;script language="JavaScript" src="/ATutor/sha-1factory.js" type="text/javascript">&lt;/script><br />
<br />
&lt;script type="text/javascript"><br />
/* <br />
 * Encrypt login password with sha1<br />
 */<br />
<br />
===<br />
===<br />
===<br />
<br />
and ending with :<br />
<br />
 onclick="return encrypt_password();" /><br />
			&lt;/div><br />
		&lt;/div><br />
	&lt;/div><br />
	&lt;/form><br />
<br />
You could take a look at : www.mycourse.co.uk if you wish.<br />
<br />
Cheers,<br />
Jim</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="14868"></a>
		<div class="forum-post-author">
			<label class="title">greg</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 11:52:03</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>It looks like you need to adjust the path to thesha-1factory.js file, changing it the a full URL to the file in your ATutor installation.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="14869"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 11:53:43</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>mmmm - tried that, no go. I'll have another attempt and perhaps give a full url to the form action tag also. back soon...<br />
Jim</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="14870"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 12:21:56</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Hi Greg,<br />
Nope - can't seem to get this to work at all. It takes the user through to the login page but still comes back with an 'invalid login/password combination' message.<br />
The only differences I can see to yours now, is the :<br />
===<br />
function encrypt_password() {<br />
	document.form1.form_password_hidden.value = hex_sha1<br />
===<br />
I have form.form - changing it makes no difference<br />
<br />
and in the :<br />
===<br />
&lt;input type="hidden" name="form_course_id" value="1" /><br />
===<br />
<br />
I have value="0" - again changing it to "1" makes no difference.<br />
<br />
Any ideas ?<br />
Thanks<br />
Jim</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="14872"></a>
		<div class="forum-post-author">
			<label class="title">harris</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-19 12:34:11</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Try changing your form name 'form' to say 'myform' and see if it works.<br />
<br />
'form' is a sensitive word.</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="14879"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-20 02:58:29</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Jim, you've applied patch #0007, right?<br />
<br />
The patch changes the login protocol, and copying those changes to your front page is required. You can compare function encrypt_password() in ATutor to that on your front page: they're different. That's where the problem lies.<br />
<br />
To fix that, you should replace the first line of that function:<br />
<br />
[php]<br />
document.myform.form_password_hidden.value = hex_sha1(document.myform.form_password.value);<br />
[/php]<br />
<br />
with<br />
<br />
[php]<br />
document.myform.form_password_hidden.value = hex_sha1(hex_sha1(document.myform.form_password.value) + "&lt;?php echo $_SESSION['token']; ?>");<br />
[/php]<br />
<br />
(without the leading and trailing PHP tags).<br />
Or, copy the line from themes/default/login.tmpl.php .</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="14883"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2008-08-20 12:12:35</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Thanks for that IndieRect,<br />
<br />
No, I did not have the correct code in there. All Patches applied but on checking this, I also saw the differences in the code from the patch 7 message.<br />
<br />
I originally copied from our own login page and then screwed up the code. <br />
<br />
When I copied the correct code in, I was still having problems. Suspecting that it was a cookie issue on my own machine - logged into a different one and checked the site - all working fine.<br />
<br />
Many thanks for helping me with this - working just great now.<br />
<br />
Cheers !<br />
Jim</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17250"></a>
		<div class="forum-post-author">
			<label class="title">adamclark1982</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-04-27 15:15:47</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>hi Guys,<br />
<br />
I have tried all of the above and really need somebodys help.<br />
<br />
<br />
<br />
On the home page I wish to place the login script is as follows:-<br />
<br />
&lt;script language="JavaScript" src="http://www.funandfit.co.uk/login/sha-1factory.js" type="text/javascript">&lt;/script><br />
<br />
&lt;script type="text/javascript"><br />
/* <br />
 * Encrypt login password with sha1<br />
 */<br />
function encrypt_password() {<br />
	document.form.form_password_hidden.value = hex_sha1(hex_sha1(document.form.form_password.value) + "&lt;?php echo $_SESSION['token']; ?>");<br />
	document.form.form_password.value = "";<br />
	return true;<br />
}<br />
<br />
&lt;/script><br />
&lt;div class="container"><br />
 <br />
	&lt;div class="column"><br />
		&lt;form action="http://www.funandfit.co.uk/login/login.php" method="post" name="form"><br />
		&lt;input type="hidden" name="form_login_action" value="true" /><br />
		&lt;input type="hidden" name="form_course_id" value="0" /><br />
		&lt;input type="hidden" name="form_password_hidden" value="" /><br />
 <br />
 <br />
		&lt;div class="input-form" style="background-color:white;"><br />
			&lt;fieldset class="group_form">&lt;legend class="group_form"><br />
			&lt;font color="#666666">Login&lt;/font>&lt;/legend><br />
			&lt;p style="margin-top: 5px; margin-bottom: 5px">&lt;font color="#666666">Mycourse Learning Management System&lt;/font>&lt;/p><br />
				<br />
				&lt;font color="#666666"><br />
				<br />
				&lt;label for="login">Login Name or Email&lt;/label>&lt;br /><br />
				&lt;font color="#808080"><br />
				&lt;input type="text" name="form_login" size="50" style="max-width: 80%; width: 80%;" id="login" />&lt;/font>&lt;br /><br />
 <br />
				&lt;label for="pass">Password&lt;/label>&lt;br /><br />
				&lt;/font>&lt;font color="#666666"><br />
				&lt;input type="password" class="formfield" name="form_password" style="max-width: 80%; width: 80%;" id="pass" /><br />
				&lt;br /><br />
				&lt;input type="submit" name="submit" value="Login" class="button" onclick="return encrypt_password();" /><br />
			&lt;/font><br />
			&lt;/fieldset>			<br />
		&lt;/div><br />
		&lt;/form><br />
<br />
<br />
<br />
I have definately patched 007, cleared my cookies. I really do not know what else to suggest, it transfers me over to the login.php page and tells me " Invalid login/password combination."<br />
<br />
I know it is the correct username and password for sure.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17252"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-04-27 16:46:13</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>HI adamclark1982,<br />
The location of the script suggests that you have the contents of ATutor installed to the root of your web. <br />
<br />
&lt;script language="JavaScript" src="http://www.funandfit.co.uk/login/sha-1factory.js" type="text/javascript">&lt;/script><br />
<br />
Is that correct ? - or should it be pointing to something like: http://www.funandfit.co.uk/ATutor/login/sha-1factory.js ?<br />
<br />
If so - alter the links to show the correct path ( and other links in the form)<br />
<br />
Good luck<br />
Jim</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17253"></a>
		<div class="forum-post-author">
			<label class="title">adamclark1982</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-04-27 16:50:04</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Hi Jim,<br />
<br />
Thank you for taking the time to reply.<br />
<br />
<br />
The locations are all correct, I renamed the atutor folder to login. This all works as if you copy and paste the url into the browser it is available.<br />
<br />
Im really stuck on this..<br />
<br />
Thanks in advance<br />
<br />
Adam.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17254"></a>
		<div class="forum-post-author">
			<label class="title">onside</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-04-27 17:11:59</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Hi Adam,<br />
<br />
aha - I realise that now. Sorry - I'm no expert, just willing to contribute - perhaps I'll leave it to the admins when they log in. <br />
<br />
One thing I can see though, is by comparing the code with that on our own site we're missing the 'SESSION etc' part of the code. Looks like our page has somehow reverted to the older version of code I had up there - however, it does seem to work. <br />
<br />
Best of luck<br />
Jim</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17267"></a>
		<div class="forum-post-author">
			<label class="title">harris</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-04-28 10:15:53</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Hi Adam,<br />
<br />
Your attached script should work perfectly fine as a theme file, so that would work perfectly in the login.tmpl.php, cause I have just tried it.<br />
<br />
Have you changed anything other than the theme code, for instance, "login.php"?</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17272"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-04-28 16:25:27</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Hello Adam,<br />
<br />
I just registered at your site (login "test", delete it if you wish) and used the code you provided here as a standalone login page. And -- it worked.<br />
<br />
So, the only thing I can think of is connected to the only change I had to make to my improvised login page: $_SESSION['token'] variable. Most probably, it's not set in the script that contains your custom login page.<br />
<br />
If that's the case, you'll need to either find some way to transmit the token from ATutor to the custom login page, or to tweak the ATutor code responsible for generating the token (be aware that the token should be random and different each time; anything else decreases security).</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17436"></a>
		<div class="forum-post-author">
			<label class="title">adamclark1982</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-14 16:34:54</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Hi Everyone,<br />
<br />
I am sorry for my late reply to this problem, I have been away and also had a flu bug.<br />
<br />
First of all thank you for your responses and ideas it is much appreciated.<br />
<br />
I have not changed anything in the login.php file but thank you for the idea.<br />
<br />
IndieRect - <br />
<br />
I am not a very experienced programmer, more of a designer and multimedia person so coding from scratch is not really an option although I will always give something a go ;-)<br />
<br />
How did you change your session token code to work?<br />
<br />
many thanks in advance<br />
<br />
adam.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17439"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-15 03:27:27</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>[purple]How did you change your session token code to work?[/purple]<br />
In short: manually. Which is why it's not a solution.<br />
See, ATutor generates a random token each time you reload the login page. A token works only until you reload the ATutor login page, for security reasons. I just copied the token [i]for that particular instance of the login form[/i] from the login page to the custom page. Manually.<br />
<br />
There are several ways to implement exchanging the token automatically. Right now I'm not ready to say which one would be better.<br />
One example I can think of right now is to make your custom script talk to a specially crafted script on the ATutor site. The only task of the latter would be to generate a fresh token, store it in $_SESSION['token'] variable and pass it to your suctom script for use in the login form.</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17440"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-15 03:29:28</p>
            </div>
            <div class="postheader"><h3>Re: Custom login script</h3></div>
				
			<div class="body">
				<p>Wow, "suctom" was a really funny invention. :)</p>
			</div>
		</div>
	</li>
</ul></div>

        </div>
         </div>
     </div>
          <footer class="site-footer">
              <div class="cd-color-4">
		<div class="cd-container">
         <div id="google_ads">
		 <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- githubfoot -->
		<ins class="adsbygoogle"
     		style="display:block"
     		data-ad-client="ca-pub-2250446123648311"
     		data-ad-slot="4063107943"
     		data-ad-format="auto"></ins>
		<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
		</script>
            </div> 
		</div> 
	</div>
      </footer>
    </section>

    
  </body>
</html>
