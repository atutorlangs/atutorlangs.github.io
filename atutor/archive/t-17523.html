---
 title: Putting a Preview link on the question editing pages
---
<div class='threadlist'>
<br /><div><a href='exported_forum1.html' class='midtext'>Back to: Thread list</a></div>
<br /><br /><div><strong>Pages:</strong><a href="exported_forum1.html?page=1">1</a> <a href="exported_forum2.html?page=2">2</a> <a href="exported_forum3.html?page=3">3</a> <a href="exported_forum4.html?page=4">4</a> <strong><a href="exported_forum5.html">5</a></strong> <a href="exported_forum6.html?page=6">6</a> <a href="exported_forum7.html?page=7">7</a> <a href="exported_forum8.html?page=8">8</a> <a href="exported_forum9.html?page=9">9</a> <a href="exported_forum10.html?page=10">10</a> <a href="exported_forum11.html?page=11">11</a> <a href="exported_forum12.html?page=12">12</a> <a href="exported_forum13.html?page=13">13</a> <a href="exported_forum14.html?page=14">14</a> <a href="exported_forum15.html?page=15">15</a> </div>
<div><p><br /><h3>Putting a Preview link on the question editing pages</h3></div><br />
<div><ul class='forum-thread'>

	<li class="even">
		<a name="17523"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 00:21:48</p>
            </div>
            <div class="postheader"><h3>Putting a Preview link on the question editing pages</h3></div>
				
			<div class="body">
				<p>Hello.  I have 1.6.2 installed and I'm trying to edit the question editing pages to put a "Preview" link there.  <br />
<br />
I have this code so far, but I can't seem to get it to take the question ID w/ it.  Any ideas?<br />
<br />
Code....<br />
&lt;a href="&lt;?php echo AT_BASE_HREF.'tools/tests/preview_question.php?$qid='.$ids; ?>" > Preview&lt;/a><br />
<br />
<br />
Thanks!</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17525"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 07:57:25</p>
            </div>
            <div class="postheader"><h3>Re: Putting a</h3></div>
				
			<div class="body">
				<p>Hi,<br />
<br />
Try using<br />
<br />
[purple]$this->row['question_id'][/purple]<br />
<br />
instead of<br />
<br />
[purple]$ids[/purple]</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17526"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 08:01:44</p>
            </div>
            <div class="postheader"><h3>Re: Putting a</h3></div>
				
			<div class="body">
				<p>Or [purple]$qid[/purple].</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17532"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 12:50:46</p>
            </div>
            <div class="postheader"><h3>Re: Putting a</h3></div>
				
			<div class="body">
				<p>Indie,<br />
<br />
Thanks for responding<br />
<br />
Using...<br />
<br />
&lt;a href="&lt;?php echo AT_BASE_HREF.'tools/tests/preview_question.php?$qid='.$this->row['question_id']; ?>" > Preview&lt;/a><br />
<br />
Produced this error...<br />
<br />
&lt;a href="<br />
Fatal error: Using $this when not in object context in /hermes/bosweb/web142/b1426/ez.liveonlinemathnet/ATutor/tools/tests/edit_question_multi.php on line 174<br />
<br />
<br />
Using...<br />
<br />
&lt;a href="&lt;?php echo AT_BASE_HREF.'tools/tests/preview_question.php?$qid='.$qid; ?>" > Preview&lt;/a><br />
<br />
Produced this error...<br />
<br />
Warning: mysql_fetch_assoc(): supplied argument is not a valid MySQL result resource in /hermes/bosweb/web142/b1426/ez.liveonlinemathnet/ATutor/tools/tests/preview_question.php on line 42<br />
<br />
<br />
However, using the $qid method did "take the question ID into the address bar".  I'm not a programmer so I don't know how to say it.  For example, basically it routed me to... <br />
<br />
http://www.liveonlinemath.com/ATutor/tools/tests/preview_question.php?$qid=9<br />
<br />
whereas without the $qid I was routed to...<br />
<br />
http://www.liveonlinemath.com/ATutor/tools/tests/preview_question.php?$qid=<br />
<br />
<br />
Any other ideas?<br />
<br />
Thanks.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17533"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 17:58:26</p>
            </div>
            <div class="postheader"><h3>Re: Putting a</h3></div>
				
			<div class="body">
				<p>Just noticed: you have and extra dollar sign in the address bar.<br />
The code fragment should look like<br />
[green]&lt;a href="&lt;?php echo AT_BASE_HREF.'tools/tests/preview_question.php?qid='.$qid; ?>" > Preview&lt;/a>[/green]<br />
instead of<br />
[red]&lt;a href="&lt;?php echo AT_BASE_HREF.'tools/tests/preview_question.php?[b]$[/b]qid='.$qid; ?>" > Preview&lt;/a>[/red]</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17534"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 20:01:32</p>
            </div>
            <div class="postheader"><h3>Perfect!</h3></div>
				
			<div class="body">
				<p>Thanks Indie!<br />
<br />
I worked around the code a little more and your solution worked perfectly.  Now I have a "Preview" button on the quesiton editing page.<br />
<br />
I've attached the edit_question_multi.php file if you'd like to see how I did it, or incorporate it into your own ATutor software.<br />
<br />
Thanks again.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17535"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-23 20:01:51</p>
            </div>
            <div class="postheader"><h3>Re: Perfect!</h3></div>
				
			<div class="body">
				<p>If you are asking for help, provide lots of detail so problems can be reproduced.<br />
<br />
Things to describe: <br />
  Operating system ATutor is installed on -<br />
  ATutor version -<br />
  Patch #s applied -<br />
  ATutor theme name -<br />
  PHP version -<br />
  MySQL version -<br />
  Webserver & version -<br />
  Copies of error messages -<br />
  Changes to default settings -<br />
  Web browser being used -<br />
  ...and anything else relevant -</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17536"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-24 00:25:21</p>
            </div>
            <div class="postheader"><h3>One more thing.....</h3></div>
				
			<div class="body">
				<p>I'm trying to create the same effect in create_question_multi.php.  When I change "question_db.php" to anything else in:<br />
<br />
$msg->addFeedback('ACTION_COMPLETED_SUCCESSFULLY');<br />
		header('Location: question_db.php');<br />
		exit;<br />
<br />
I get:<br />
<br />
Warning: mysql_fetch_assoc(): supplied argument is not a valid MySQL result resource in /hermes/bosweb/web142/b1426/ez.liveonlinemathnet/ATutor/tools/tests/preview_question.php on line 42<br />
<br />
<br />
Any ideas on this one?<br />
<br />
Thanks again for the help.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17537"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-24 02:49:14</p>
            </div>
            <div class="postheader"><h3>Re: One more thing.....</h3></div>
				
			<div class="body">
				<p>You're welcome.<br />
<br />
As to the last post, it's most likely that the $qid variable is not set yet at the point where you try to use it.<br />
Assuming the changes are the same as in edit_question_multi.php, it may be fixed by adding the line<br />
[green]$qid = mysql_insert_id($db);[/green]<br />
after<br />
[purple]$result	= mysql_query($sql, $db);[/purple]</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17540"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-24 18:52:31</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Indie,<br />
<br />
Thanks for your help so far.  Your suggestion worked perfectly!<br />
<br />
The final piece of what I want to do is, after previewing the question, easily get back to editing it.  I've thought of two ways to do this, but I haven't been successful in either.......<br />
<br />
1.) Add a "Edit" button to preview_question.php that would take you to the proper edit_question_XXX.php page.  I tried inserting...<br />
<br />
} else if (isset($_GET['edit'])) {<br />
	$id  = current($_GET['questions']);<br />
	$num_selected = count($id);<br />
<br />
	if ($num_selected == 1) {<br />
		$ids = explode('|', $id[0], 2);<br />
		$o = TestQuestions::getQuestion($ids[1]);<br />
		if ($name = $o->getPrefix()) {<br />
			header[red] ('Location: '.AT_BASE_HREF.'tools/tests/edit_question_'.$name.'.php?qid='.intval($ids[0])) [/red];<br />
			exit;<br />
		} else {<br />
			header('Location: '.AT_BASE_HREF.'tools/tests/index.php');<br />
			exit;<br />
		}<br />
	}<br />
<br />
from question_db.php, but I couldn't get it to work.<br />
<br />
<br />
2.) Add a "back" button to preview_question.php.  However, that wil only take you back to create_question_xxx.php.  My idea is to add code to create_question_xxx.php (with a button to activate it) that mirrors the code from edit_question_xxx.php that posts the information to the database.  <br />
<br />
Any further ideas on either of these?  I think #1 would probably be easier, but I just couldn't get it to work.<br />
<br />
Thanks again for the help.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17543"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-25 05:45:34</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Hi,<br />
<br />
Yeah, I expected that to be the next question. :)<br />
You might try something like this:<br />
[green]&lt;input type="button" name="back" value="Back" onclick="history.back(1);" />[/green]</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17548"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-25 11:37:00</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Great minds think alike? :D <br />
<br />
I actually already did that.  The problem is that it takes you back to the create_question_xxx.php file instead of edit_question_xxx.php.<br />
<br />
The more I think about it, the more it seems that option 1 (that I listed above) would be easier.  I just can't get the syntax to work.<br />
<br />
Does what I have in option 1 look reasonable to you?<br />
<br />
Thanks again.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17550"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-25 17:36:28</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Right, going back client-side won't do it.<br />
<br />
The fragment in option 1 doesn't work because you copied it from a different file with completely different data structures. That's why there's no such thing as $_GET['questions'] there -- consequently, it doesn't work.<br />
Try to figure out which data you have available in each case and how they differ -- that's a good first step when making such changes.<br />
<br />
In preview_question.php you should be using the object stored in $obj variable inside the loop. So, the right starting point would be:<br />
[green]<br />
	if ($name = $obj->getPrefix()) {<br />
			header('Location: '.AT_BASE_HREF.'tools/tests/edit_question_'.$name.'.php?qid='.$row['question_id'];<br />
			exit;<br />
		}<br />
[/green]<br />
You'll probably need a separate "Edit" button near each question, so you'll have to edit the code accordingly; however, the general approach to getting the right URL remains the same.</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17552"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-26 00:28:48</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Ok.  I'm not good at PHP as all, and I'm not a programmer, so I'm trying to follow what you're saying but I'm just not getting it.<br />
<br />
Here's what I tried and it didn't work (I got a 500 internal server error).<br />
<br />
In preview_question.php, under:<br />
<br />
if (defined('AT_FORCE_GET_FILE') && AT_FORCE_GET_FILE) {<br />
	$content_base_href = 'get.php/';<br />
} else {<br />
	$content_base_href = 'content/' . $_SESSION['course_id'] . '/';<br />
}<br />
<br />
<br />
I put:<br />
<br />
//Added for "Edit Question" button<br />
<br />
if (isset($_GET['edit'])) {<br />
	$msg->addError('NO_ITEM_SELECTED');<br />
} else if ($name = $obj->getPrefix()) {<br />
		header('Location: '.AT_BASE_HREF.'tools/tests/edit_question_'.$name.'.php?qid='.$row['question_id'];<br />
		exit;<br />
	} <br />
<br />
//End added<br />
<br />
<br />
And above: <br />
<br />
&lt;div class="row buttons">&lt;input type="submit" name="submit" value="&lt;?php echo _AT('back'); ?>"/>&lt;/div><br />
<br />
I put:<br />
<br />
&lt;div class="row buttons">&lt;input type="submit" name="edit" value="Edit Question"/>&lt;/div><br />
<br />
<br />
If you're tired of weighing in on this, I understand.  And if I'm not even close, then don't worry about it.<br />
<br />
Thanks for your continued help.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17562"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-27 02:48:57</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>I'm always glad to help getting the most out of ATutor. Just got too little time for that lately.<br />
<br />
You're moving in the right direction. Unfortunately, it seems it would be easier to write the working code than to explain all of the details, and right now I haven't got time for that. I guess you could seek for someone else's assistance; or, I believe I'll be available again in mid-June.<br />
<br />
I'm sorry for that. The change is not all too complex, I believe you'll easily find someone to make it if you need it right now.</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17571"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-05-27 09:50:23</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>No worries Indie.  There's no rush on this.<br />
<br />
I'll reply to this post again in mid-June and I would greatly appreciate help with getting this implemented.</p>
			</div>
		</div>
	</li>

	<li class="even">
		<a name="17788"></a>
		<div class="forum-post-author">
			<label class="title">gtilflm</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-06-16 11:33:48</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Indie,<br />
<br />
Just wondering if you had time to pick this up again.<br />
<br />
If not, then no problem.<br />
<br />
Thanks!</p>
			</div>
		</div>
	</li>

	<li class="odd">
		<a name="17811"></a>
		<div class="forum-post-author">
			<label class="title">IndieRect</label><br />
		</div>

		<div class="forum-post-content">
			
			<div class="date">
                <p>2009-06-18 16:48:32</p>
            </div>
            <div class="postheader"><h3>Re: One more thing... (again)</h3></div>
				
			<div class="body">
				<p>Hi,<br />
<br />
Sorry to say that, but summer seems to really be the hottest season this year -- got to embark on a third trip in a row.<br />
So right now I can't may any predictions as to when I'll be available again.</p>
			</div>
		</div>
	</li>
</ul></div>
